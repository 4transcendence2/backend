<html>
  <head>
		<script src="https://cdn.socket.io/4.6.0/socket.io.min.js" integrity="sha384-c79GN5VsunZvi+Q/WObgk2in0CbZsHnjEqvFxC5DxHn9lTfNce2WW6h2pH6u/kF+" crossorigin="anonymous"></script>
    <script>
			const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InNvcmtzb2VrMjIyMiIsInN1YiI6ODEsImlhdCI6MTY4MDk0OTA3NSwiZXhwIjoxNjgxMjA4Mjc1fQ.O1-BEp78JmXa0VZ34FKqESOZ2oqLqw3l8YrEPOnkCaM';
			const socket = io('ws://localhost', {
				extraHeaders: {
					Authorization: 'Bearer ' + token,
				}
			})
			function join() {
				socket.emit('joinChatRoom', { room_id: 107, data: 'hello' });
			};

			function exit() {
				socket.emit('exitChatRoom', { room_id: 107, data: 'hello' });
			};

			function addFriend() {
				socket.emit('addFriend', { username: 'sorksoek22222'});
			};

			function createChatRoom() {
				socket.emit('createChatRoom', {
					status: "public",
					title: "sijfhsadkjfhsadf"
				});
			};

			socket.on('createChatRoomResult', data => {
				console.log(data);
			})

			socket.on('joinChatRoomResult', data => {
				console.log(data);
			});

			socket.on('addFriendResult', data => {
				console.log(data);
			});

			socket.on('chat', (data) => {
				console.log(data);
			})

			socket.on('error', (error) => {
				console.log(error);
			})

			socket.on('notice', data => {
				console.log(data);
			})

			socket.on('updateFriend', data => {
				console.log('friend');
				console.log(data);
			})


			socket.on('updateChatRoomList', data => {
				console.log('chatRoomList');
				console.log(data);
			})

			socket.on('updateMyChatRoomList', data => {
				console.log('myChatRoomList');
				console.log(data);
			})

			socket.on('updateDmList', data => {
				console.log('dmList');
				console.log(data);
			})


			async function submitForm() {
				req.open('POST', 'http://localhost/user/avatar', true);
				req.setRequestHeader('Authorization', token);
				req.setRequestHeader('Content-Type', 'multipart/form-data');
				
				const token = "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfaWQiOjUyLCJ1c2VybmFtZSI6InNvcmtzb2VrMiIsImlhdCI6MTY4MDQ5MjAzOSwiZXhwIjoxNjgwNjY0ODM5fQ.Mu63apzXx2zsTUKA31IvpU_s2JfrsWKXQwyYxBT4J4U";
				const file = (document.getElementById('image')).files[0];
				const formData = new FormData();
				formData.append('avatar', file);
				fetch('http://localhost/user/avatar', {
					method: 'POST',
					body: formData,
					headers: {
						'Authorization': token,
					}
				}).then(res => {
					console.log(res);
				}).catch(err => {
					console.log(err);
				})
			}

    </script>
  </head>

  <body>
		<button onclick="join()">joinChatRoom</button>
		<button onclick="exit()">exitChatRoom</button>
		<button onclick="addFriend()">addFriend</button>
		<button onclick="createChatRoom()">createChatRoom</button>


		<form action="http://localhost/user/avatar" id="myForm" method="Post" enctype="multipart/form-data">
			<label for="image">Select a PNG image to upload:</label><br>
			<input id="image" type="file" id="image" name="image"><br><br>
			<input type="submit" value="Upload" onclick="submitForm()">
		</form>
		<button value="CLICK" onclick="submitForm()">CLICK HERE</button>
	</body>
</html>